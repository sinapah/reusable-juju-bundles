bundle: kubernetes
applications:
  alertmanager:
    charm: alertmanager-k8s
    channel: 2/edge
    revision: 179
    resources:
      alertmanager-image: 100
    scale: 1
    constraints: arch=amd64
    storage:
      data: kubernetes,1,1024M
    trust: true
  catalogue2:
    charm: local:catalogue-k8s-12
    scale: 1
    options:
      override_hostname: 10.0.0.0
    constraints: arch=amd64
    trust: true
  grafana:
    charm: grafana-k8s
    channel: 2/edge
    revision: 162
    resources:
      grafana-image: 71
      litestream-image: 46
    scale: 1
    constraints: arch=amd64
    storage:
      database: kubernetes,1,1024M
    trust: true
  loki:
    charm: loki-coordinator-k8s
    channel: 2/edge
    revision: 43
    resources:
      nginx-image: 7
      nginx-prometheus-exporter-image: 3
    scale: 1
    constraints: arch=amd64
    trust: true
  loki-worker:
    charm: loki-worker-k8s
    channel: 2/edge
    revision: 50
    resources:
      loki-image: 3
    scale: 1
    options:
      role-all: true
    constraints: arch=amd64
    storage:
      loki-persisted: kubernetes,1,1024M
    trust: true
  mimir:
    charm: local:mimir-coordinator-k8s-5
    resources:
      nginx-image: 15
      nginx-prometheus-exporter-image: 4
    scale: 1
    constraints: arch=amd64
    trust: true
  mimir-worker:
    charm: mimir-worker-k8s
    channel: 2/edge
    revision: 56
    resources:
      mimir-image: 16
    scale: 1
    options:
      role-all: true
    constraints: arch=amd64
    storage:
      data: kubernetes,1,1024M
      recovery-data: kubernetes,1,1024M
    trust: true
  prom:
    charm: prometheus-k8s
    channel: 2/edge
    revision: 262
    resources:
      prometheus-image: 151
    scale: 1
    constraints: arch=amd64
    storage:
      database: kubernetes,1,1024M
    trust: true
  swfs:
    charm: seaweedfs-k8s
    channel: latest/edge
    revision: 7
    resources:
      seaweedfs-image: 1
    scale: 1
    constraints: arch=amd64
    storage:
      data: kubernetes,1,10240M
  traefik:
    charm: traefik-k8s
    channel: latest/edge
    revision: 244
    base: ubuntu@20.04/stable
    resources:
      traefik-image: 162
    scale: 1
    options:
      external_hostname: ""
    constraints: arch=amd64
    storage:
      configurations: kubernetes,1,1024M
    trust: true
relations:
  - - mimir:mimir-cluster
    - mimir-worker:mimir-cluster
  - - mimir:s3
    - swfs:s3-credentials
  - - loki:loki-cluster
    - loki-worker:loki-cluster
  - - loki:s3
    - swfs:s3-credentials
  - - grafana:grafana-dashboard
    - mimir:grafana-dashboards-provider
  - - grafana:grafana-source
    - mimir:grafana-source
  - - grafana:grafana-dashboard
    - loki:grafana-dashboards-provider
  - - grafana:grafana-source
    - loki:grafana-source
  - - traefik:grafana-dashboard
    - grafana:grafana-dashboard
  - - traefik:traefik-route
    - grafana:ingress
  - - traefik:ingress
    - loki:ingress
  - - traefik:ingress
    - mimir:ingress
  - - alertmanager:grafana-source
    - grafana:grafana-source
  - - alertmanager:grafana-dashboard
    - grafana:grafana-dashboard
  - - alertmanager:alerting
    - mimir:alertmanager
  - - alertmanager:alerting
    - loki:alertmanager
  - - traefik:ingress
    - alertmanager:ingress
  - - catalogue2:catalogue
    - loki:catalogue
  - - catalogue2:catalogue
    - mimir:catalogue
  - - catalogue2:ingress
    - traefik:ingress
  - - catalogue2:catalogue
    - alertmanager:catalogue
  - - catalogue2:catalogue
    - grafana:catalogue
  - - prom:catalogue
    - catalogue2:catalogue
  - - prom:ingress
    - traefik:ingress-per-unit
